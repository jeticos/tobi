(function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports?module.exports=t():e.Tobi=t()})(this,function(){"use strict";var e=function(e){var t={},n=window,r=null,i=0,o=null,a=null,l=null,d=null,s=null,u=null,c={},p=!1,f=!1,b=!1,m=null,g=null,h=null,v=null,y=null,A=!1,w=!1,_=[],E=[],L=0,x={gallery:[],slider:null,sliderElements:[],elementsLength:0,currentIndex:0,x:0},C={},S="default",I=!1,T=[],N=function(e){var t={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:['<svg role="img" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24"><polyline points="14 18 8 12 14 6 14 6"></polyline></svg>','<svg role="img" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24"><polyline points="10 6 16 12 10 18 10 18"></polyline></svg>'],navLabel:["Previous","Next"],close:!0,closeText:'<svg role="img" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24"><path d="M6.34314575 6.34314575L17.6568542 17.6568542M6.34314575 17.6568542L17.6568542 6.34314575"></path></svg>',closeLabel:"Close",loadingIndicatorLabel:"Image loading",counter:!0,download:!1,downloadText:"",downloadLabel:"Download",keyboard:!0,zoom:!0,zoomText:'<svg role="img" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><polyline points="21 16 21 21 16 21"/><polyline points="8 21 3 21 3 16"/><polyline points="16 3 21 3 21 8"/><polyline points="3 8 3 3 8 3"/></svg>',docClose:!0,swipeClose:!0,hideScrollbar:!0,draggable:!0,threshold:100,rtl:!1,loop:!1,autoplayVideo:!1,theme:"dark",grouping:!0,groupAttribute:"data-group"};return e&&Object.keys(e).forEach(function(n){t[n]=e[n]}),t},P=function(){return"string"==typeof document.documentElement.style.transform?"transform":"WebkitTransform"},k={image:{checkSupport:function(e){return!e.hasAttribute("data-type")&&e.href.match(/\.(png|jpe?g|tiff|tif|gif|bmp|webp|svg|ico)$/i)},init:function(e,n){var r=document.createElement("figure"),o=document.createElement("figcaption"),a=document.createElement("img"),l=e.querySelector("img"),d=document.createElement("div");a.style.opacity="0",l&&(a.alt=l.alt||""),a.setAttribute("src",""),a.setAttribute("data-src",e.href),r.appendChild(a),t.captions&&(o.style.opacity="0","self"===t.captionsSelector&&e.getAttribute(t.captionAttribute)?o.textContent=e.getAttribute(t.captionAttribute):"img"===t.captionsSelector&&l&&l.getAttribute(t.captionAttribute)&&(o.textContent=l.getAttribute(t.captionAttribute)),o.textContent&&(o.id="tobi-figcaption-"+i,r.appendChild(o),a.setAttribute("aria-labelledby",o.id),++i)),n.appendChild(r),d.className="tobi-loader",d.setAttribute("role","progressbar"),d.setAttribute("aria-label",t.loadingIndicatorLabel),n.appendChild(d),n.setAttribute("data-type","image")},onPreload:function(e){k.image.onLoad(e)},onLoad:function(e){var t=e.querySelector("img");if(t.hasAttribute("data-src")){var n=e.querySelector("figcaption"),r=e.querySelector(".tobi-loader");t.onload=function(){e.removeChild(r),t.style.opacity="1",n&&(n.style.opacity="1")},t.setAttribute("src",t.getAttribute("data-src")),t.removeAttribute("data-src")}},onLeave:function(e){},onCleanup:function(e){}},html:{checkSupport:function(e){return fe(e,"html")},init:function(e,t){var n=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target"),r=document.querySelector(n);if(!r)throw new Error("Ups, I can't find the target "+n+".");t.appendChild(r),t.setAttribute("data-type","html")},onPreload:function(e){},onLoad:function(e){var n=e.querySelector("video");n&&(n.hasAttribute("data-time")&&n.readyState>0&&(n.currentTime=n.getAttribute("data-time")),t.autoplayVideo&&n.play())},onLeave:function(e){var t=e.querySelector("video");t&&(t.paused||t.pause(),t.readyState>0&&t.setAttribute("data-time",t.currentTime))},onCleanup:function(e){var t=e.querySelector("video");if(t&&t.readyState>0&&t.readyState<3&&t.duration!==t.currentTime){var n=t.cloneNode(!0);be(t),t.load(),t.parentNode.removeChild(t),e.appendChild(n)}}},iframe:{checkSupport:function(e){return fe(e,"iframe")},init:function(e,t){var n=document.createElement("iframe"),r=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target");n.setAttribute("frameborder","0"),n.setAttribute("src",""),n.setAttribute("data-src",r),t.appendChild(n),t.setAttribute("data-type","iframe")},onPreload:function(e){},onLoad:function(e){var t=e.querySelector("iframe");t.setAttribute("src",t.getAttribute("data-src"))},onLeave:function(e){},onCleanup:function(e){}},youtube:{checkSupport:function(e){return fe(e,"youtube")},init:function(e,t){var n=document.createElement("div");t.appendChild(n),E[L]=new window.YT.Player(n,{host:"https://www.youtube-nocookie.com",height:e.getAttribute("data-height")||"360",width:e.getAttribute("data-width")||"640",videoId:e.getAttribute("data-id"),playerVars:{controls:e.getAttribute("data-controls")||1,rel:0,playsinline:1}}),t.setAttribute("data-player",L),t.setAttribute("data-type","youtube"),L++},onPreload:function(e){},onLoad:function(e){t.autoplayVideo&&E[e.getAttribute("data-player")].playVideo()},onLeave:function(e){1===E[e.getAttribute("data-player")].getPlayerState()&&E[e.getAttribute("data-player")].pauseVideo()},onCleanup:function(e){1===E[e.getAttribute("data-player")].getPlayerState()&&E[e.getAttribute("data-player")].pauseVideo()}}},q=function(e){t=N(e),r=P(),o||V();var n=document.querySelectorAll(t.selector);if(!n)throw new Error("Ups, I can't find the selector "+t.selector+".");Array.prototype.forEach.call(n,function(e){X(e)})},X=function(e){if(null===document.querySelector('[data-type="youtube"]')||w)U(e);else{if(null===document.getElementById("iframe_api")){var t=document.createElement("script"),n=document.getElementsByTagName("script")[0];t.id="iframe_api",t.src="https://www.youtube.com/iframe_api",n.parentNode.insertBefore(t,n)}-1===_.indexOf(e)&&_.push(e),window.onYouTubePlayerAPIReady=function(){Array.prototype.forEach.call(_,function(e){U(e)}),w=!0}}},Y=function(e){if(!t.grouping)return"default";let n=t.groupAttribute;return e.hasAttribute(n)&&e.getAttribute(n).length>0?e.getAttribute(n):"default"},O=function(e){let t=Y(e);C.hasOwnProperty(t)||(C[t]=D(x)),S=t,z()},M=function(){return C[S]},D=function(e){return JSON.parse(JSON.stringify(e))},U=function(e,n){if(ye()&&Y(e)!==S)return I=!0,void T.push(e);O(e);let r=M();if(-1!==r.gallery.indexOf(e))throw new Error("Ups, element already added to the lightbox.");if(r.gallery.push(e),r.elementsLength++,t.zoom&&e.querySelector("img")){var i=document.createElement("div");i.className="tobi-zoom__icon",i.innerHTML=t.zoomText,e.classList.add("tobi-zoom"),e.appendChild(i)}e.addEventListener("click",function(e){e.preventDefault(),Ee(Y(this)),H(r.gallery.indexOf(this))}),B(e),ye()&&(me(),he()),n&&n.call(this)},z=function(){let e=M();e.slider||(e.slider=document.createElement("div"),e.slider.className="tobi__slider",u.appendChild(e.slider))},V=function(){o=document.createElement("div"),o.setAttribute("role","dialog"),o.setAttribute("aria-hidden","true"),o.className="tobi tobi--theme-"+t.theme,u=document.createElement("div"),u.className="tobi__slider--container",o.appendChild(u),a=document.createElement("button"),a.className="tobi__prev",a.setAttribute("type","button"),a.setAttribute("aria-label",t.navLabel[0]),a.innerHTML=t.navText[0],o.appendChild(a),l=document.createElement("button"),l.className="tobi__next",l.setAttribute("type","button"),l.setAttribute("aria-label",t.navLabel[1]),l.innerHTML=t.navText[1],o.appendChild(l),d=document.createElement("button"),d.className="tobi__close",d.setAttribute("type","button"),d.setAttribute("aria-label",t.closeLabel),d.innerHTML=t.closeText,o.appendChild(d),s=document.createElement("div"),s.className="tobi__counter",o.appendChild(s),n.addEventListener("resize",function(){A||(A=!0,n.requestAnimationFrame(function(){$(),A=!1}))}),document.body.appendChild(o)},B=function(e){for(var t in k)if(k.hasOwnProperty(t)&&k[t].checkSupport(e)){let i=M();var n=document.createElement("div"),r=document.createElement("div");n.className="tobi__slider__slide",n.style.position="absolute",n.style.left=100*i.x+"%",r.className="tobi__slider__slide__content",k[t].init(e,r),n.appendChild(r),i.slider.appendChild(n),i.sliderElements.push(n),++i.x;break}},H=function(e,n){let r=M();if(ye()||e||(e=0),ye()){if(!e)throw new Error("Ups, Tobi is aleady open.");if(e===r.currentIndex)throw new Error("Ups, slide "+e+" is already selected.")}if(-1===e||e>=r.elementsLength)throw new Error("Ups, I can't find slide "+e+".");t.hideScrollbar&&(document.documentElement.classList.add("tobi-is-open"),document.body.classList.add("tobi-is-open")),me(),t.close||(d.disabled=!1,d.setAttribute("aria-hidden","true")),m=document.activeElement,r.currentIndex=e,ee(),ce(),G(r.currentIndex),o.setAttribute("aria-hidden","false"),he(),R(r.currentIndex+1),R(r.currentIndex-1),n&&n.call(this)},j=function(e){if(!ye())throw new Error("Tobi is already closed.");t.hideScrollbar&&(document.documentElement.classList.remove("tobi-is-open"),document.body.classList.remove("tobi-is-open")),pe(),m.focus();let n=M();var r=n.sliderElements[n.currentIndex].querySelector(".tobi__slider__slide__content"),i=r.getAttribute("data-type");if(k[i].onLeave(r),k[i].onCleanup(r),o.setAttribute("aria-hidden","true"),n.currentIndex=0,I){I=!1;for(let e=0;e<T.length;e+=1){let t=T[e];U(t)}}e&&e.call(this)},R=function(e){let t=M();if(void 0!==t.sliderElements[e]){var n=t.sliderElements[e].querySelector(".tobi__slider__slide__content"),r=n.getAttribute("data-type");k[r].onPreload(n)}},G=function(e){let t=M();if(void 0!==t.sliderElements[e]){var n=t.sliderElements[e].querySelector(".tobi__slider__slide__content"),r=n.getAttribute("data-type");k[r].onLoad(n)}},J=function(e){let t=M();t.currentIndex>0&&(F(t.currentIndex),G(--t.currentIndex),he("left"),K(t.currentIndex+1),R(t.currentIndex-1),e&&e.call(this))},W=function(e){let t=M();t.currentIndex<t.elementsLength-1&&(F(t.currentIndex),G(++t.currentIndex),he("right"),K(t.currentIndex-1),R(t.currentIndex+1),e&&e.call(this))},F=function(e){let t=M();if(void 0!==t.sliderElements[e]){var n=t.sliderElements[e].querySelector(".tobi__slider__slide__content"),r=n.getAttribute("data-type");k[r].onLeave(n)}},K=function(e){let t=M();if(void 0!==t.sliderElements[e]){var n=t.sliderElements[e].querySelector(".tobi__slider__slide__content"),r=n.getAttribute("data-type");k[r].onCleanup(n)}},$=function(){let e=M();v=-e.currentIndex*window.innerWidth,e.slider.style[r]="translate3d("+v+"px, 0, 0)",y=v},Q=function(){let e=M();s.textContent=e.currentIndex+1+"/"+e.elementsLength},Z=function(e){var n=null,r=M();t.nav?(a.disabled=!1,l.disabled=!1,1===r.elementsLength?(a.disabled=!0,l.disabled=!0,t.close&&d.focus()):0===r.currentIndex?a.disabled=!0:r.currentIndex===r.elementsLength-1&&(l.disabled=!0),e||l.disabled?e||!l.disabled||a.disabled?l.disabled||"right"!==e?l.disabled&&"right"===e&&!a.disabled?a.focus():a.disabled||"left"!==e?a.disabled&&"left"===e&&!l.disabled&&l.focus():a.focus():l.focus():a.focus():l.focus()):t.close&&d.focus(),n=o.querySelectorAll("button:not(:disabled)"),g=n[0],h=1===n.length?n[0]:n[n.length-1]},ee=function(){c={startX:0,endX:0,startY:0,endY:0}},te=function(){let e=M();var n=c.endX-c.startX,r=c.endY-c.startY,i=Math.abs(n),o=Math.abs(r);n>0&&i>t.threshold&&e.currentIndex>0?J():n<0&&i>t.threshold&&e.currentIndex!==e.elementsLength-1?W():r<0&&o>t.threshold&&t.swipeClose?j():$()},ne=function(e){e.target===a?J():e.target===l?W():(e.target===d||"tobi__slider__slide"===e.target.className&&t.docClose)&&j(),e.stopPropagation()},re=function(e){9===e.keyCode||"Tab"===e.code?e.shiftKey?document.activeElement===g&&(h.focus(),e.preventDefault()):document.activeElement===h&&(g.focus(),e.preventDefault()):27===e.keyCode||"Escape"===e.code?(e.preventDefault(),j()):37===e.keyCode||"ArrowLeft"===e.code?(e.preventDefault(),J()):39!==e.keyCode&&"ArrowRight"!==e.code||(e.preventDefault(),W())},ie=function(e){if(we(e.target))return;e.stopPropagation(),b=!0,c.startX=e.touches[0].pageX,c.startY=e.touches[0].pageY;let t=M();t.slider.classList.add("tobi__slider--is-dragging")},oe=function(e){e.stopPropagation(),b&&(e.preventDefault(),c.endX=e.touches[0].pageX,c.endY=e.touches[0].pageY,ue())},ae=function(e){e.stopPropagation(),b=!1;let t=M();t.slider.classList.remove("tobi__slider--is-dragging"),c.endX&&(p=!1,f=!1,te()),ee()},le=function(e){if(we(e.target))return;e.preventDefault(),e.stopPropagation(),b=!0,c.startX=e.pageX,c.startY=e.pageY;let t=M();t.slider.classList.add("tobi__slider--is-dragging")},de=function(e){e.preventDefault(),b&&(c.endX=e.pageX,c.endY=e.pageY,ue())},se=function(e){e.stopPropagation(),b=!1;let t=M();t.slider.classList.remove("tobi__slider--is-dragging"),c.endX&&(p=!1,f=!1,te()),ee()},ue=function(){let e=M();Math.abs(c.startX-c.endX)>0&&!f&&t.swipeClose?(e.slider.style[r]="translate3d("+(y-Math.round(c.startX-c.endX))+"px, 0, 0)",p=!0,f=!1):Math.abs(c.startY-c.endY)>0&&!p&&(e.slider.style[r]="translate3d("+y+"px, -"+Math.round(c.startY-c.endY)+"px, 0)",p=!1,f=!0)},ce=function(){t.keyboard&&document.addEventListener("keydown",re),o.addEventListener("click",ne),t.draggable&&(Ae()&&(o.addEventListener("touchstart",ie),o.addEventListener("touchmove",oe),o.addEventListener("touchend",ae)),o.addEventListener("mousedown",le),o.addEventListener("mouseup",se),o.addEventListener("mousemove",de))},pe=function(){t.keyboard&&document.removeEventListener("keydown",re),o.removeEventListener("click",ne),t.draggable&&(Ae()&&(o.removeEventListener("touchstart",ie),o.removeEventListener("touchmove",oe),o.removeEventListener("touchend",ae)),o.removeEventListener("mousedown",le),o.removeEventListener("mouseup",se),o.removeEventListener("mousemove",de))},fe=function(e,t){return e.getAttribute("data-type")===t},be=function(e){var t=e.querySelectorAll("src");t&&Array.prototype.forEach.call(t,function(e){e.setAttribute("src","")})},me=function(){let e=M();t.draggable&&e.elementsLength>1&&!e.slider.classList.contains("tobi__slider--is-draggable")&&e.slider.classList.add("tobi__slider--is-draggable"),!t.nav||1===e.elementsLength||"auto"===t.nav&&Ae()?(a.setAttribute("aria-hidden","true"),l.setAttribute("aria-hidden","true")):(a.setAttribute("aria-hidden","false"),l.setAttribute("aria-hidden","false")),t.counter&&1!==e.elementsLength?s.setAttribute("aria-hidden","false"):s.setAttribute("aria-hidden","true")},ge=function(){for(let e in C)C.hasOwnProperty(e)&&(C[e].slider.style.display=S===e?null:"none")},he=function(e){ge(),$(),Q(),Z(e)},ve=function(e){let t=M();if(t.slider)for(;t.slider.firstChild;)t.slider.removeChild(t.slider.firstChild);t.gallery.length=t.sliderElements.length=t.elementsLength=i=t.x=0,e&&e.call(this)},ye=function(){return"false"===o.getAttribute("aria-hidden")},Ae=function(){return"ontouchstart"in window},we=function(e){let t=M();return-1!==["TEXTAREA","OPTION","INPUT","SELECT"].indexOf(e.nodeName)||e===a||e===l||e===d||1===t.elementsLength},_e=function(){let e=M();return e.currentIndex},Ee=function(e){if(t.grouping){if(!C.hasOwnProperty(e))throw new Error("Ups, I don't have a group called \""+e+'".');S=e}else S="default"},Le=function(e){t.grouping||console.warn("Ups, grouping is disabled."),Ee(e)};return q(e),{open:H,prev:J,next:W,close:j,add:X,reset:ve,isOpen:ye,currentSlide:_e,selectGroup:Le,getGroupName:Y}};return e});